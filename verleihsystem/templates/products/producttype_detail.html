{% extends "base.html" %}

{% block extra_css %}
	<link rel="stylesheet" href="{{ MEDIA_URL }}css/producttype_detail.css">
{% endblock %}

{% block content %}
<div id="breadcrumbs">
{% for c in producttype.categories.all %}
	{% if forloop.first %}
		<p><a href="/">Home</a>
	{% else %}
		<p><span style="visibility:hidden">Home</span>
	{% endif %}
	{% for a in c.get_ancestors %}
		&raquo; <a href="{{ a.get_absolute_url }}">{{ a.name }}</a>
	{% endfor %}
	&raquo; <a href="{{ c.get_absolute_url }}">{{ c.name }}</a>
	&raquo; {{ producttype.name }}
	</p>
{% endfor %}
</div>
<h1>{{ producttype.name }}</h1>
<div id="producttype_detail">
	<p class="photo">
	{% if producttype.picture %}
		<img src="{{ producttype.picture.url }}" />
	{% else %}
		<img src="{{ MEDIA_URL }}img/no_picture.png" />
	{% endif %}
	</p>
	<p class="description">
		{{ producttype.description }}
	</p>
</div>
<div class="clear">
<table id="product_list">
	<colgroup>
		<col width="150px">
		<col width="">
		<col width="150px">
	</colgroup>
	<thead>
		<tr>
			<td>ID/Serial No.</td>
			<td>Beschreibung</td>
			<td></td>
		</tr>
	</thead>
	<tbody>
	{% for product in product_list %}
		{% cycle 'odd' 'even' as rowcolors silent %}
		<tr class="{{ rowcolors }}">
			<td>{{ product.sn }}</td>
			<td>{{ product.brief_description }}</td>
			<td class="actions">
			{% if product in request.session.cart %}
				<a href="#"><img src="{{ MEDIA_URL }}img/icon/calendar.png" /></a>
				<a href="/cart/remove?id={{ product.id }}"><img src="{{ MEDIA_URL }}img/icon/cart_minus.png" /></a>
			{% else %}
				<a href="/cart/add?id={{ product.id }}"><img src="{{ MEDIA_URL }}img/icon/cart_plus.png" /></a>
			{% endif %}
			</td>
		</tr>
		<tr class="{{ rowcolors }}">
			<td colspan="3">
			<table class="timeline">
				<tbody>
					<tr>
                        <td class="back">
                        {% with year=previous_range|date:"Y" month=previous_range|date:"m" day=previous_range|date:"d" %}
                            <a href="{{ request.url }}?timeline={{ year }}-{{ month }}-{{ day }}">&laquo;</a>
                            <!--
                            JavaScript JSON Link: {% url reservation_date_list year month day product.id %}
                            -->
                        {% endwith %}
						</td>
                    {% for day in product.timeline %}
						<td>
							<p class="date">{{ day.date|date:"d.m" }}</p>
							{% if day.reserved %}
								<p class="reserved" title="Reserviert">&nbsp;</p>
							{% else %}
								<p class="free" title="Frei">&nbsp;</p>
							{% endif %}
                        </td>
                    {% endfor %}
                        <td class="forward">
                        {% with year=next_range|date:"Y" month=next_range|date:"m" day=next_range|date:"d" %}
                            <a href="{{ request.url }}?timeline={{ year }}-{{ month }}-{{ day }}">&raquo;</a>
                            <!--
                            JavaScript JSON Link: {% url reservation_date_list year month day product.id %}
                            -->
                        {% endwith %}
						</td>
					</tr>
				</tbody>
			</table>
			</td>
		</tr>
	{% endfor %}
	</tbody>
</table>
{% endblock %}
